[{"id":"66ece34c.1cb6dc","type":"function","z":"8c33d01c.9cece","name":"","func":"switch(msg.topic){\n    case \"SoundNode01/sensor\":\n        flow.set(\"sensor\", msg.payload);\n        // msg = null;\n        break;\n    case \"SoundNode01/sound\":\n        flow.set(\"sound\",msg.payload);\n        // msg = null;\n        break;\n}\n\nlet sound = flow.get(\"sound\");\nlet sensor = flow.get(\"sensor\");\nlet sensorHigh = flow.get(\"sensorHigh\");\nlet sensorLow = flow.get(\"sensorLow\");\n\nlet mappedSensor = map_range(sensor, sensorHigh, sensorLow, 80, 200);\n\nif (mappedSensor <= sound || sensor >= sensorHigh) {\n    msg.payload = \"C\";\n} else if(mappedSensor >= sound || sensor <= sensorLow){\n    msg.payload = \"O\";\n}\n\n// msg.payload = mappedSensor;\n\nreturn msg;\n\nfunction map_range(x, in_min, in_max, out_min, out_max) {\n  return (x - in_min) * (out_max - out_min) / (in_max - in_min) + out_min;\n}","outputs":1,"noerr":0,"x":690,"y":620,"wires":[["d6f2da88.66dff8","10c8ddd3.95f582"]]}]